<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Amanda Mejia, Preya Shah &amp; Damon Pham" />

<meta name="date" content="2021-08-07" />

<title>Projection scrubbing for outlier detection in high-dimensional data with fMRIscrub</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Projection scrubbing for outlier detection in high-dimensional data with <code>fMRIscrub</code></h1>
<h4 class="author">Amanda Mejia, Preya Shah &amp; Damon Pham</h4>
<h4 class="date">2021-08-07</h4>



<p><code>fMRIscrub</code> is an R package that implements routines for cleaning fMRI data, namely data-driven scrubbing (projection scrubbing and DVARS), motion scrubbing (framewise displacement), anatomical CompCor, detrending, and nuisance regression. Several of these methods are also applicable to other high-dimensional data analysis tasks. For example, projection scrubbing can be used as a general outlier detection method.</p>
<p>In this vignette we will highlight the use of projection scrubbing for identifying and removing contaminated volumes from fMRI scans. Projection scrubbing works by identifying component directions in the data likely to represent artifactual patterns, and then computing a composite measure for the amount of these signals at each volume. The projection can be PCA, ICA, or “fused PCA,” and the composite measure is based on the linear model concept of leverage. (An earlier version of projection scrubbing was named “PCA leverage”). Like other scrubbing methods, it is designed to detect “burst noise” which occurs due to transient artifact sources such as subject head motion. Projection scrubbing can be cited with the following papers:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">&quot;fMRIscrub&quot;</span>)[<span class="fu">seq</span>(<span class="dv">2</span>)]</span></code></pre></div>
<pre><code>## 
## Mejia AF, Nebel MB, Eloyan A, Caffo B, Lindquist MA (2017). &quot;PCA
## leverage: outlier detection for high-dimensional functional magnetic
## resonance imaging data.&quot; _Biostatistics_, *18*(3), 521-536. doi:
## 10.1093/biostatistics/kxw050 (URL:
## https://doi.org/10.1093/biostatistics/kxw050).
## 
## Afyouni S, Nichols TE (2018). &quot;Insight and inference for DVARS.&quot;
## _Neuroimage_, *172*, 291-312. doi: 10.1016/j.neuroimage.2017.12.098
## (URL: https://doi.org/10.1016/j.neuroimage.2017.12.098), This citation
## is for the DVARS measure of outlyingness.
## 
## To see these entries in BibTeX format, use &#39;print(&lt;citation&gt;,
## bibtex=TRUE)&#39;, &#39;toBibtex(.)&#39;, or set
## &#39;options(citation.bibtex.max=999)&#39;.</code></pre>
<p>Citations for the other routines included in <code>fMRIscrub</code> are listed at the end of this document.</p>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>Install the package from GitHub and load it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&#39;mandymejia/fMRIscrub&#39;)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fMRIscrub)</span></code></pre></div>
</div>
<div id="tutorial" class="section level1">
<h1>Tutorial</h1>
<div id="data" class="section level3">
<h3>Data</h3>
<p><code>fMRIscrub</code> includes resting-state scans from two subjects in the Autism and Brain Imaging Data Exchange (ABIDE), a publicly available neuroimaging resource <a href="https://doi.org/10.1038/mp.2013.78">(Di Martino and others, 2014)</a>. The first scan contains artifacts likely due to a couple periods of high subject head motion; the second is relatively artifact-free. The data represent axial slices instead of the entire brain to minimize the package size of <code>fMRIscrub</code>.</p>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p>The data for both subjects consist of a single slice from an fMRI volume. A brain mask has been applied to vectorize the data, forming a <span class="math inline">\(T \times V\)</span> (time by voxel) matrix. These are automatically added into the environment upon loading <code>fMRIscrub</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Dat1)</span></code></pre></div>
<pre><code>## [1]  193 4675</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Dat2)</span></code></pre></div>
<pre><code>## [1]  145 4679</code></pre>
<p>We will now run projection scrubbing on both datasets. We’ll use the default implementation (ICA leverage), except that we will detrend the components’ first and second moments. (Although the data is mean-detrended prior to component estimation, mean and variance trends may still manifest in the component timeseries. These trends are removed because they interfere with the use of kurtosis and leverage in subsequent steps. Mean and variance detrending is turned off by default because more rigorous detrending of the original data, for example with anatomical CompCor, can sufficiently reduce the long-term trends in the components. Since the CSF and white matter data are unavailable for these scans, we use component detrending instead of anatomical CompCor.)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Dat1.lev <span class="ot">=</span> <span class="fu">clever</span>(Dat1, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">comps_mean_dt=</span><span class="dv">1</span>, <span class="at">comps_var_dt=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 283 constant data columns (out of 4675).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing leverage.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as: scrub(Dat1, verbose=TRUE, comps_mean_dt=1, comps_var_dt=1)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Dat2.lev <span class="ot">=</span> <span class="fu">clever</span>(Dat2, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">comps_mean_dt=</span><span class="dv">1</span>, <span class="at">comps_var_dt=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 68 constant data columns (out of 4679).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing leverage.</code></pre>
<p>Let’s take a look at the leverage timeseries with <code>plot</code>. The flagged timepoints are highlighted by the grey bars.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(Dat1.lev, <span class="at">title=</span><span class="st">&quot;Dat1&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(Dat2.lev, <span class="at">title=</span><span class="st">&quot;Dat2&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>ICA leverage indicates clear outliers in the first dataset around the 60th and 150th timepoints. While the second dataset is relatively artifact-free, A few timepoints are still flagged including around the 40th and 110th timepoints.</p>
<p>DVARS, another data-driven scrubbing technique, yields similar results:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">DVARS</span>(Dat1), <span class="at">title=</span><span class="st">&quot;Dat1&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># same as: plot(scrub(Dat1, &quot;DVARS&quot;), title=&quot;Dat1&quot;, show.legend=FALSE)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">DVARS</span>(Dat2), <span class="at">title=</span><span class="st">&quot;Dat2&quot;</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fmri-image-reconstruction" class="section level3">
<h3>fMRI image reconstruction</h3>
<p>Let’s see what was going on in the first scan. We can reconstruct the original fMRI image using the mask which was applied to vectorize it.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(oro.nifti)</span></code></pre></div>
<pre><code>## oro.nifti 0.11.0</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neurobase)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unmask the first scan</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">=</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Dat1_mask.nii.gz&quot;</span>, <span class="at">package =</span> <span class="st">&quot;fMRIscrub&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Mask1 <span class="ot">=</span> <span class="fu">readNIfTI</span>(fname) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="co">#Pitt_0050048 (full of artifacts)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Mask1 <span class="ot">=</span> <span class="fu">array</span>(Mask1, <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">dim</span>(Mask1), <span class="dv">1</span>)) <span class="co"># 2D --&gt; 3D slice</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Img1 <span class="ot">=</span> fMRIscrub<span class="sc">::</span><span class="fu">unmask_vol</span>(<span class="fu">t</span>(Dat1), Mask1)</span></code></pre></div>
<p>We will compare the timepoint of median leverage (left) to the timepoint of maximum leverage (right).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>levs <span class="ot">=</span> Dat1.lev<span class="sc">$</span>measure</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>t_med <span class="ot">=</span> <span class="fu">order</span>(levs)[<span class="fu">ceiling</span>(<span class="fu">length</span>(levs)<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>t_max <span class="ot">=</span> <span class="fu">which.max</span>(levs)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Img1[,,,t_med], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Median lev (T = &#39;</span>, t_med, <span class="st">&#39;)&#39;</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Img1[,,,t_max], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Maximum lev (T = &#39;</span>, t_max, <span class="st">&#39;)&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The median time point appears normal, whereas the most outlying time point clearly has banding artifacts likely due to subject motion.</p>
</div>
<div id="leverage-images" class="section level3">
<h3>Leverage images</h3>
<p><code>fMRIscrub</code> can also display the “leverage images” for each outlying observation. These are based on the projection directions for the selected components. There are two types of leverage images: the composite of the selected directions, weighed by the variance-normalized scores for that timepoint, and the single direction with the strongest signal at that timepoint. Here are the leverage images at 60 for the first dataset:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>clev <span class="ot">&lt;-</span> <span class="fu">clever</span>(Dat1, <span class="at">projection=</span><span class="st">&quot;ICA&quot;</span>, <span class="at">get_dirs=</span><span class="cn">TRUE</span>, <span class="at">comps_mean_dt=</span><span class="dv">1</span>, <span class="at">comps_var_dt=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning in clever_multi(X = X, projection = projection, nuisance = nuisance, : Removing 283 constant data columns (out of 4675).</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Lev_Img1 <span class="ot">=</span> <span class="fu">lev_images</span>(clev)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Constant voxels are deleted during the `clever` algorithm, so the leverage images will have</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># missing values where the constant voxels were. The NA_fill option is used here to make</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># these voxels have the same color as the background (out-of-mask voxels).</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>Lev_Img1.mean <span class="ot">=</span> <span class="fu">unmask_vol</span>(<span class="fu">t</span>(Lev_Img1<span class="sc">$</span>mean), Mask1)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>Lev_Img1.top <span class="ot">=</span> <span class="fu">unmask_vol</span>(<span class="fu">t</span>(Lev_Img1<span class="sc">$</span>top), Mask1)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">which</span>(clev<span class="sc">$</span>outlier_flag) <span class="sc">==</span> t_max)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Lev_Img1.mean[,,<span class="dv">1</span>,idx], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Lev image, mean (T=&#39;</span>,t_max,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(Lev_Img1.top[,,<span class="dv">1</span>,idx], <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;Lev image, top (T=&#39;</span>,t_max,<span class="st">&#39;)&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The leverage images highlight the banding artifact present at this time point.</p>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="more-information-about-projection-scrubbing" class="section level3">
<h3>More information about projection scrubbing</h3>
<p>As input, <code>clever</code> takes a <span class="math inline">\(T\)</span> x <span class="math inline">\(V\)</span> matrix, <span class="math inline">\(Y\)</span>. In our case, <span class="math inline">\(Y\)</span> represents an fMRI run: each row is a vectorized volume, and each column represents the timeseries of a single data location. Next, the algorithm performs the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Perform a nuisance regression with four discrete cosine transform (DCT) bases to remove low-frequency trends in the data. This helps the data projection method better identify the artifactual components.</p></li>
<li><p>Normalize <span class="math inline">\(Y\)</span> by centering and scaling its columns robustly.</p></li>
<li><p>Decompose the data into <span class="math inline">\(Q \times V\)</span> projection directions and their <span class="math inline">\(T \times Q\)</span> signal timecourses using PCA, ICA, or fused PCA. The projection directions are the <span class="math inline">\(V\)</span> matrix in PCA and fused PCA (<span class="math inline">\(Y = UDV^T\)</span>), and the <span class="math inline">\(M\)</span> matrix in ICA (<span class="math inline">\(Y = MS\)</span>). The signal timecourses are the <span class="math inline">\(U\)</span> matrix in PCA and fused PCA, and the <span class="math inline">\(S\)</span> matrix in ICA. By default, ICA projection is used, and <span class="math inline">\(Q\)</span> is determined by the “PESEL” algorithm.</p></li>
<li><p>Select <span class="math inline">\(K &lt; Q\)</span> of the <span class="math inline">\(Q\)</span> components which are likely to contain artifact information. By default, we select high-variance and high-kurtosis components, since burst noise tends to manifest as deviations of much greater magnitude than would be expected of neuronal signals.</p></li>
<li><p>Measure leverage across the <span class="math inline">\(K\)</span> components. If <span class="math inline">\(C\)</span> is the matrix of selected components, then leverage is the diagonal of the hat matrix <span class="math inline">\(C(C^TC)^{-1}C^T\)</span>. The <span class="math inline">\(T\)</span> leverage values are interpreted as a measure of outlyingness at each timepoint.</p></li>
<li><p>Leverage is thresholded to obtain the set of identified outliers. By default, timepoints with leverage greater than three times the median across all timepoints are flagged as outliers.</p></li>
</ol>
</div>
<div id="running-multiple-versions-of-projection-scrubbing-at-a-time" class="section level3">
<h3>Running multiple versions of projection scrubbing at a time</h3>
<p>For testing purposes, we can run multiple methods at the same time using the internal function <code>clever_multi</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Dat1.levAll <span class="ot">&lt;-</span> fMRIscrub<span class="sc">:::</span><span class="fu">clever_multi</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  Dat1, <span class="at">projection=</span><span class="st">&quot;all&quot;</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>, <span class="at">comps_mean_dt=</span><span class="dv">1</span>, <span class="at">comps_var_dt=</span><span class="dv">1</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Checking for missing, infinite, and constant data.</code></pre>
<pre><code>## Warning in fMRIscrub:::clever_multi(Dat1, projection = &quot;all&quot;, verbose = TRUE, : Removing 283 constant data columns (out of 4675).</code></pre>
<pre><code>## Performing nuisance regression.
## Centering and scaling the data columns.
## Computing PCA.
## Computing PCATF.
## Computing ICA.
## Computing leverage.</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(Dat1.levAll) # Doesn&#39;t work yet!</span></span></code></pre></div>
</div>
<div id="citations-for-other-routines-included-in-fmriscrub" class="section level3">
<h3>Citations for other routines included in <code>fMRIscrub</code></h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#citation(&quot;fMRIscrub&quot;)[seq(3, length(citation(&quot;fMRIscrub&quot;)))]</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
